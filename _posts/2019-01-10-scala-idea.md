---
title: "在 IntelliJ IDEA 中运行 scala 无法加载主类的解决方法"
tags: [Data mining, Spark, scala]
---
## 在 IntelliJ IDEA 中运行 scala 无法加载主类的解决方法

在科研任务的实验中，数据集中没有记录司机的接单距离，所以我们只好通过司机的 GPS 轨迹数据，来判断司机在接受一个订单时其所在的地理位置，进而获得他的接单距离。 

在 GPS 轨迹数据中，主要包含精度，经纬度，时间戳，司机 id, 是否空闲，非空闲时的 order_request_id。该轨迹数据并不是很完善，具体表现为一个司机的 GPS 轨迹记录并不是像滴滴那样每隔几秒钟就记录一次，而是可能隔几秒，也可能隔几分钟才记录一次。在以前的实验中，我首先把司机空闲的数据记录过滤掉，再对每个司机非空闲情况下的 GPS 轨迹按照时间进行排序，进而就可以获得每个司机在非空闲时的第一条轨迹记录。最后，通过比对每条记录的 order_request_id，就可以大概得到每个司机的接单距离。

但这样的方案存在一些问题，如果一个司机在非空闲时的第一条轨迹记录离实际的接单时间较远，那么该记录所代表的经纬度其实并不是司机真实的接单距离。所以在这次实验中，不能再对司机空闲的记录进行过滤，而是应该对每个司机所有的GPS的记录进行排序，进而得到接单时刻前的一条记录以及截单时间后的一条记录。然后，可以再在这两个记录之间通过一定方法进行权衡，进而得到最终的接单的距离。

由于数据集的形式为每天的 GPS 记录存储为一个 csv 文件，且每个 csv 文件所包含的条目数量较多，占用存储空间较大，而且最后需要将每个 csv 的统计信息合成到一个文件中，所以此时如果仍然继续使用 python 中的 pandas 进行数据分析，就会有巨大的效率问题。为了解决这些问题，我打算继续在 spark 平台上对该数据集进行分析。 

当我打算直接在以前的 spark 实验代码基础上进行修改时，却发现在运行 demo 时 IntelliJ idea 显示无法加载 scala 主类。网上的大部分解决方法都是针对 sdk 的，而我的工程中 sdk 的设置是没有问题的。山重水复之时，发现我居然没有把 demo 所在的文件夹设置为 source 目录, 难怪文件夹图标都没有变为 source 目录中该有的图标形式。解决了这个问题后，demo 果然顺利跑起来了。

![source](https://github.com/cruddev/cruddev.github.io/blob/master/_posts/imgs/source.png)

![source](https://github.com/cruddev/cruddev.github.io/blob/master/_posts/imgs/source_dir.png)